{"version":3,"sources":["components/EditPost.js"],"names":["baseURL","process","REACT_APP_BASEURL","EditPost","props","state","title","body","author","date","isLoggedIn","handleChange","bind","handleSubmit","handleEditorChange","axios","get","this","match","params","id","then","post","setState","data","comments","catch","err","console","error","sessionStorage","getItem","event","editor","getData","target","name","value","preventDefault","document","querySelector","style","display","sanitizedData","sanitizeHtml","editedPost","res","window","location","className","role","onSubmit","type","onChange","required","ClassicEditor","config","toolbar","onClick","data-dismiss","aria-label","aria-hidden","Component"],"mappings":"qPAMMA,EAAUC,0WAAYC,mBAAqB,wBAE3CC,E,kDACF,WAAYC,GAAQ,IAAD,8BACf,cAAMA,IAEDC,MAAQ,CACTC,MAAO,GACPC,KAAM,GACNC,OAAQ,GACRC,KAAM,GACNC,YAAY,GAGhB,EAAKC,aAAe,EAAKA,aAAaC,KAAlB,gBACpB,EAAKC,aAAe,EAAKA,aAAaD,KAAlB,gBACpB,EAAKE,mBAAqB,EAAKA,mBAAmBF,KAAxB,gBAbX,E,gEAgBE,IAAD,OAChBG,IACKC,IADL,UACYhB,EADZ,yBACoCiB,KAAKb,MAAMc,MAAMC,OAAOC,KACvDC,MAAK,SAACC,GACH,EAAKC,SAAS,CACVjB,MAAOgB,EAAKE,KAAKlB,MACjBC,KAAMe,EAAKE,KAAKjB,KAChBC,OAAQc,EAAKE,KAAKhB,OAClBC,KAAMa,EAAKE,KAAKf,KAChBgB,SAAUH,EAAKE,KAAKC,cAG3BC,OAAM,SAACC,GAAD,OAASC,QAAQC,MAAMF,MAEW,SAAzCG,eAAeC,QAAQ,eACvBd,KAAKM,SAAS,CAAEb,YAAY,M,yCAIjBsB,EAAOC,GACtBhB,KAAKM,SAAS,CAAEhB,KAAM0B,EAAOC,c,mCAGpBF,GAAQ,IAAD,EACQA,EAAMG,OAAtBC,EADQ,EACRA,KAAMC,EADE,EACFA,MAEdpB,KAAKM,SAAL,eACKa,EAAOC,M,mCAIHL,GAAQ,IAAD,OAChBA,EAAMM,iBAGNC,SAASC,cAAc,sBAAsBC,MAAMC,QAAU,UAE7D,IAAMC,EAAgBC,IAAa3B,KAAKZ,MAAME,MAC9CU,KAAKM,SAAS,CAAEhB,KAAMoC,IAEtB,IAAME,EAAa,CACfvC,MAAOW,KAAKZ,MAAMC,MAClBE,OAAQS,KAAKZ,MAAMG,OACnBD,KAAMU,KAAKZ,MAAME,KACjBE,KAAMQ,KAAKZ,MAAMI,KACjBgB,SAAUR,KAAKZ,MAAMoB,UAGzBV,IACKO,KADL,UAEWtB,EAFX,8BAEwCiB,KAAKb,MAAMc,MAAMC,OAAOC,IACxDyB,GAEHxB,MAEG,SAACyB,GAAD,OACKC,OAAOC,SAAP,iBAA4B,EAAK5C,MAAMc,MAAMC,OAAOC,OAE5DM,OAAM,SAACC,GAAD,OAASC,QAAQC,MAAMF,Q,+BAIlC,OAAIV,KAAKZ,MAAMK,WAEP,6BAEI,yBACIuC,UAAU,oBACVR,MAAO,CAAEC,QAAS,SAElB,yBAAKO,UAAU,iBAAiBC,KAAK,UACjC,0BAAMD,UAAU,WAAhB,gBAGR,yBAAKA,UAAU,aACX,6CACkB,0BAAMA,UAAU,aAAhB,MAElB,0BAAME,SAAUlC,KAAKJ,cACjB,yBAAKoC,UAAU,cACX,2BAAOA,UAAU,cAAjB,WACA,2BACIA,UAAU,0BACVG,KAAK,OACLhB,KAAK,QACLC,MAAOpB,KAAKZ,MAAMC,MAClB+C,SAAUpC,KAAKN,aACf2C,UAAQ,KAIhB,6BACI,kBAAC,IAAD,CACIrB,OAAQsB,IACR/B,KAAMP,KAAKZ,MAAME,KACjB8C,SAAUpC,KAAKH,mBACf0C,OAAQ,CACJC,QAAS,CACL,UACA,IACA,OACA,SACA,OACA,eACA,eACA,IACA,aACA,aACA,OACA,YAKhB,6BACA,yBAAKR,UAAU,cACX,2BACIG,KAAK,SACLf,MAAM,cACNY,UAAU,uCAS9B,yBACIA,UAAU,sBACVC,KAAK,QACLQ,QAAS,kBAAOX,OAAOC,SAAW,WAHtC,uCAMI,4BACII,KAAK,SACLH,UAAU,QACVU,eAAa,QACbC,aAAW,SAEX,0BAAMC,cAAY,OAAOZ,UAAU,eAAnC,OACY,W,GA9Jba,aAuKR3D","file":"static/js/12.fd37b234.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport CKEditor from \"@ckeditor/ckeditor5-react\";\r\nimport ClassicEditor from \"@ckeditor/ckeditor5-build-classic\";\r\nimport sanitizeHtml from \"sanitize-html\";\r\n\r\nconst baseURL = process.env.REACT_APP_BASEURL || \"http://localhost:5000\";\r\n\r\nclass EditPost extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            title: \"\",\r\n            body: \"\",\r\n            author: \"\",\r\n            date: \"\",\r\n            isLoggedIn: false,\r\n        };\r\n\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n        this.handleEditorChange = this.handleEditorChange.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        axios\r\n            .get(`${baseURL}/server/posts/${this.props.match.params.id}`)\r\n            .then((post) => {\r\n                this.setState({\r\n                    title: post.data.title,\r\n                    body: post.data.body,\r\n                    author: post.data.author,\r\n                    date: post.data.date,\r\n                    comments: post.data.comments,\r\n                });\r\n            })\r\n            .catch((err) => console.error(err));\r\n\r\n        if (sessionStorage.getItem(\"isLoggedIn\") === \"true\") {\r\n            this.setState({ isLoggedIn: true });\r\n        }\r\n    }\r\n\r\n    handleEditorChange(event, editor) {\r\n        this.setState({ body: editor.getData() });\r\n    }\r\n\r\n    handleChange(event) {\r\n        const { name, value } = event.target;\r\n\r\n        this.setState({\r\n            [name]: value,\r\n        });\r\n    }\r\n\r\n    handleSubmit(event) {\r\n        event.preventDefault();\r\n\r\n        // Display a spinner until the post is submitted\r\n        document.querySelector(\".spinner-container\").style.display = \"flexbox\";\r\n\r\n        const sanitizedData = sanitizeHtml(this.state.body);\r\n        this.setState({ body: sanitizedData });\r\n\r\n        const editedPost = {\r\n            title: this.state.title,\r\n            author: this.state.author,\r\n            body: this.state.body,\r\n            date: this.state.date,\r\n            comments: this.state.comments,\r\n        };\r\n\r\n        axios\r\n            .post(\r\n                `${baseURL}/server/posts/edit/${this.props.match.params.id}`,\r\n                editedPost\r\n            )\r\n            .then(\r\n                // redirect to SHOW page\r\n                (res) =>\r\n                    (window.location = `/posts/${this.props.match.params.id}`)\r\n            )\r\n            .catch((err) => console.error(err));\r\n    }\r\n\r\n    render() {\r\n        if (this.state.isLoggedIn) {\r\n            return (\r\n                <div>\r\n                    {/* A spinner to indicate loading until new post is submitted */}\r\n                    <div\r\n                        className=\"spinner-container\"\r\n                        style={{ display: \"none\" }}\r\n                    >\r\n                        <div className=\"spinner-border\" role=\"status\">\r\n                            <span className=\"sr-only\">Loading...</span>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"edit-post\">\r\n                        <h1>\r\n                            Edit Blog Post<span className=\"full-stop\">.</span>\r\n                        </h1>\r\n                        <form onSubmit={this.handleSubmit}>\r\n                            <div className=\"form-group\">\r\n                                <label className=\"edit-title\">Title: </label>\r\n                                <input\r\n                                    className=\"form-control edit-title\"\r\n                                    type=\"text\"\r\n                                    name=\"title\"\r\n                                    value={this.state.title}\r\n                                    onChange={this.handleChange}\r\n                                    required\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <CKEditor\r\n                                    editor={ClassicEditor}\r\n                                    data={this.state.body}\r\n                                    onChange={this.handleEditorChange}\r\n                                    config={{\r\n                                        toolbar: [\r\n                                            \"Heading\",\r\n                                            \"|\",\r\n                                            \"Bold\",\r\n                                            \"Italic\",\r\n                                            \"Link\",\r\n                                            \"NumberedList\",\r\n                                            \"BulletedList\",\r\n                                            \"|\",\r\n                                            \"BlockQuote\",\r\n                                            \"MediaEmbed\",\r\n                                            \"Undo\",\r\n                                            \"Redo\",\r\n                                        ],\r\n                                    }}\r\n                                />\r\n                            </div>\r\n                            <br />\r\n                            <div className=\"form-group\">\r\n                                <input\r\n                                    type=\"submit\"\r\n                                    value=\"Submit Post\"\r\n                                    className=\"btn btn-outline-primary btn-lg\"\r\n                                />\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } else {\r\n            return (\r\n                <div\r\n                    className=\"alert alert-warning\"\r\n                    role=\"alert\"\r\n                    onClick={() => (window.location = \"/login\")}\r\n                >\r\n                    You need to login to edit your post!\r\n                    <button\r\n                        type=\"button\"\r\n                        className=\"close\"\r\n                        data-dismiss=\"alert\"\r\n                        aria-label=\"Close\"\r\n                    >\r\n                        <span aria-hidden=\"true\" className=\"alert-close\">\r\n                            &times;{\" \"}\r\n                        </span>\r\n                    </button>\r\n                </div>\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\nexport default EditPost;\r\n"],"sourceRoot":""}